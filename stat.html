<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jiayi Shi" />

<meta name="date" content="2022-12-09" />

<title>Statistical Analysis</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Exploratory Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="eda.html">Eda about restaurants in NYC</a>
    </li>
    <li>
      <a href="map.html"></a>
    </li>
  </ul>
</li>
<li>
  <a href="stat_analysis.html">Statistical Analysis</a>
</li>
<li>
  <a href="report.html">Project Report</a>
</li>
<li>
  <a href="https://sweetsugar.shinyapps.io/recommender">Shiny app</a>
</li>
<li>
  <a href="mailto:&lt;js6177@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/xx2416/p8105_final">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Statistical Analysis</h1>
<h4 class="author">Jiayi Shi</h4>
<h4 class="date">2022-12-09</h4>

</div>


<pre class="r"><code>library(readr)
dt = read_csv(&quot;data/inspection_sub_all_date.csv&quot;)</code></pre>
<pre><code>## Warning: One or more parsing issues, see `problems()` for details</code></pre>
<pre><code>## Rows: 54562 Columns: 32
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (17): dba, boro, building, street, cuisine_description, action, violati...
## dbl  (12): camis, zipcode, phone, score, latitude, longitude, community_boar...
## date  (3): inspection_date, grade_date, record_date
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>df = read_csv(&quot;data/inspection_sub_latest_date.csv&quot;) %&gt;%
  distinct(dba, .keep_all = TRUE) %&gt;% 
  mutate(price = fct_recode(price, &quot;1&quot; = &quot;$&quot;, &quot;2&quot; = &quot;$$&quot;, &quot;3&quot; = &quot;$$$&quot;, &quot;4&quot; = &quot;$$$$&quot;),
         boro = fct_reorder(boro, rating),
         grade = fct_relevel(grade, &quot;A&quot;))</code></pre>
<pre><code>## Rows: 20181 Columns: 32
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (18): dba, boro, building, street, phone, cuisine_description, grade, i...
## dbl  (11): camis, zipcode, score, latitude, longitude, community_board, bin,...
## date  (3): inspection_date, grade_date, record_date
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>df %&gt;% 
  select(boro, grade, price) %&gt;% 
  mutate(boro = fct_infreq(boro)) %&gt;% 
  tbl_summary(
    by = boro,
    missing_text = &quot;(Missing)&quot;, 
    statistic = list(
      all_categorical() ~ &quot;{n} ({p}%)&quot;
      )) %&gt;% 
  bold_labels() %&gt;%   
  italicize_levels() </code></pre>
<div id="pgtsrmwqss" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pgtsrmwqss .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pgtsrmwqss .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pgtsrmwqss .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pgtsrmwqss .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pgtsrmwqss .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pgtsrmwqss .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pgtsrmwqss .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pgtsrmwqss .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pgtsrmwqss .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pgtsrmwqss .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pgtsrmwqss .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pgtsrmwqss .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#pgtsrmwqss .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pgtsrmwqss .gt_from_md > :first-child {
  margin-top: 0;
}

#pgtsrmwqss .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pgtsrmwqss .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pgtsrmwqss .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pgtsrmwqss .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pgtsrmwqss .gt_row_group_first td {
  border-top-width: 2px;
}

#pgtsrmwqss .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pgtsrmwqss .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pgtsrmwqss .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pgtsrmwqss .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pgtsrmwqss .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pgtsrmwqss .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pgtsrmwqss .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pgtsrmwqss .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pgtsrmwqss .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pgtsrmwqss .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pgtsrmwqss .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pgtsrmwqss .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pgtsrmwqss .gt_left {
  text-align: left;
}

#pgtsrmwqss .gt_center {
  text-align: center;
}

#pgtsrmwqss .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pgtsrmwqss .gt_font_normal {
  font-weight: normal;
}

#pgtsrmwqss .gt_font_bold {
  font-weight: bold;
}

#pgtsrmwqss .gt_font_italic {
  font-style: italic;
}

#pgtsrmwqss .gt_super {
  font-size: 65%;
}

#pgtsrmwqss .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#pgtsrmwqss .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pgtsrmwqss .gt_indent_1 {
  text-indent: 5px;
}

#pgtsrmwqss .gt_indent_2 {
  text-indent: 10px;
}

#pgtsrmwqss .gt_indent_3 {
  text-indent: 15px;
}

#pgtsrmwqss .gt_indent_4 {
  text-indent: 20px;
}

#pgtsrmwqss .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>Manhattan</strong>, N = 1,985<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>Brooklyn</strong>, N = 1,424<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>Queens</strong>, N = 1,087<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>Bronx</strong>, N = 331<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>Staten Island</strong>, N = 171<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left" style="font-weight: bold;">grade</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    A</td>
<td class="gt_row gt_center">1,002 (69%)</td>
<td class="gt_row gt_center">747 (71%)</td>
<td class="gt_row gt_center">524 (70%)</td>
<td class="gt_row gt_center">137 (66%)</td>
<td class="gt_row gt_center">105 (76%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    B</td>
<td class="gt_row gt_center">35 (2.4%)</td>
<td class="gt_row gt_center">35 (3.3%)</td>
<td class="gt_row gt_center">26 (3.5%)</td>
<td class="gt_row gt_center">5 (2.4%)</td>
<td class="gt_row gt_center">1 (0.7%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    C</td>
<td class="gt_row gt_center">15 (1.0%)</td>
<td class="gt_row gt_center">8 (0.8%)</td>
<td class="gt_row gt_center">11 (1.5%)</td>
<td class="gt_row gt_center">8 (3.8%)</td>
<td class="gt_row gt_center">0 (0%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    N</td>
<td class="gt_row gt_center">195 (13%)</td>
<td class="gt_row gt_center">119 (11%)</td>
<td class="gt_row gt_center">100 (13%)</td>
<td class="gt_row gt_center">36 (17%)</td>
<td class="gt_row gt_center">22 (16%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    Z</td>
<td class="gt_row gt_center">210 (14%)</td>
<td class="gt_row gt_center">142 (14%)</td>
<td class="gt_row gt_center">84 (11%)</td>
<td class="gt_row gt_center">22 (11%)</td>
<td class="gt_row gt_center">10 (7.2%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    (Missing)</td>
<td class="gt_row gt_center">528</td>
<td class="gt_row gt_center">373</td>
<td class="gt_row gt_center">342</td>
<td class="gt_row gt_center">123</td>
<td class="gt_row gt_center">33</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">price</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    1</td>
<td class="gt_row gt_center">430 (22%)</td>
<td class="gt_row gt_center">479 (35%)</td>
<td class="gt_row gt_center">380 (37%)</td>
<td class="gt_row gt_center">125 (42%)</td>
<td class="gt_row gt_center">47 (29%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    2</td>
<td class="gt_row gt_center">1,215 (63%)</td>
<td class="gt_row gt_center">799 (59%)</td>
<td class="gt_row gt_center">604 (59%)</td>
<td class="gt_row gt_center">162 (54%)</td>
<td class="gt_row gt_center">105 (65%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    3</td>
<td class="gt_row gt_center">235 (12%)</td>
<td class="gt_row gt_center">75 (5.5%)</td>
<td class="gt_row gt_center">34 (3.3%)</td>
<td class="gt_row gt_center">9 (3.0%)</td>
<td class="gt_row gt_center">8 (4.9%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    4</td>
<td class="gt_row gt_center">49 (2.5%)</td>
<td class="gt_row gt_center">10 (0.7%)</td>
<td class="gt_row gt_center">8 (0.8%)</td>
<td class="gt_row gt_center">2 (0.7%)</td>
<td class="gt_row gt_center">2 (1.2%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    (Missing)</td>
<td class="gt_row gt_center">56</td>
<td class="gt_row gt_center">61</td>
<td class="gt_row gt_center">61</td>
<td class="gt_row gt_center">33</td>
<td class="gt_row gt_center">9</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="6"><sup class="gt_footnote_marks">1</sup> n (%)</td>
    </tr>
  </tfoot>
</table>
</div>
<pre class="r"><code>df %&gt;% 
  select(score,rating, review_num) %&gt;% 
  tbl_summary(
    missing_text = &quot;(Missing)&quot;, 
    statistic = list(
      all_continuous() ~ &quot;{mean} ({sd})&quot;
      )) %&gt;% 
  bold_labels() %&gt;%   
  italicize_levels() </code></pre>
<div id="qooeuifsqz" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qooeuifsqz .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qooeuifsqz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qooeuifsqz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qooeuifsqz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qooeuifsqz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qooeuifsqz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qooeuifsqz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qooeuifsqz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qooeuifsqz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qooeuifsqz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qooeuifsqz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qooeuifsqz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qooeuifsqz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qooeuifsqz .gt_from_md > :first-child {
  margin-top: 0;
}

#qooeuifsqz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qooeuifsqz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qooeuifsqz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qooeuifsqz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qooeuifsqz .gt_row_group_first td {
  border-top-width: 2px;
}

#qooeuifsqz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qooeuifsqz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qooeuifsqz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qooeuifsqz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qooeuifsqz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qooeuifsqz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qooeuifsqz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qooeuifsqz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qooeuifsqz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qooeuifsqz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qooeuifsqz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qooeuifsqz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qooeuifsqz .gt_left {
  text-align: left;
}

#qooeuifsqz .gt_center {
  text-align: center;
}

#qooeuifsqz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qooeuifsqz .gt_font_normal {
  font-weight: normal;
}

#qooeuifsqz .gt_font_bold {
  font-weight: bold;
}

#qooeuifsqz .gt_font_italic {
  font-style: italic;
}

#qooeuifsqz .gt_super {
  font-size: 65%;
}

#qooeuifsqz .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#qooeuifsqz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qooeuifsqz .gt_indent_1 {
  text-indent: 5px;
}

#qooeuifsqz .gt_indent_2 {
  text-indent: 10px;
}

#qooeuifsqz .gt_indent_3 {
  text-indent: 15px;
}

#qooeuifsqz .gt_indent_4 {
  text-indent: 20px;
}

#qooeuifsqz .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>N = 4,998</strong><sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left" style="font-weight: bold;">score</td>
<td class="gt_row gt_center">18 (14)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    (Missing)</td>
<td class="gt_row gt_center">100</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">rating</td>
<td class="gt_row gt_center">3.78 (0.68)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">review_num</td>
<td class="gt_row gt_center">232 (485)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="2"><sup class="gt_footnote_marks">1</sup> Mean (SD)</td>
    </tr>
  </tfoot>
</table>
</div>
<div id="chi-square-test" class="section level2">
<h2>Chi-square Test</h2>
<p>We try to determine whether there is a relationship between boroughs
and restaurants’ inspection grades. Our hypothesis is that there is no
difference in the number of restaurants across the five grades across
the five boroughs in NYC. We will perform the chi-square test to verify
our assumption.</p>
<p><span class="math inline">\(H0\)</span>: the expected number of
restaurants in each grades are the same across all boroughs.</p>
<p><span class="math inline">\(H1\)</span>: the expected number of
restaurants in each grades are not same across all boroughs.</p>
<pre class="r"><code>grade_boro = 
  df %&gt;% 
  drop_na(grade) %&gt;% 
  count(boro, grade) %&gt;% 
  pivot_wider(
    names_from = &quot;grade&quot;,
    values_from = &quot;n&quot;) %&gt;%
  replace(is.na(.), 0) %&gt;% 
  data.matrix() %&gt;%
  subset(select = -c(boro))

rownames(grade_boro) &lt;- c(&quot;Bronx&quot;, &quot;Staten Island&quot;, &quot;Queens&quot;, &quot;Brooklyn&quot;, &quot;Manhattan&quot;)

grade_boro %&gt;% 
  knitr::kable(caption = &quot;Results Table&quot;)</code></pre>
<table>
<caption>Results Table</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
<th align="right">N</th>
<th align="right">Z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bronx</td>
<td align="right">137</td>
<td align="right">5</td>
<td align="right">8</td>
<td align="right">36</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="left">Staten Island</td>
<td align="right">105</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">22</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="left">Queens</td>
<td align="right">524</td>
<td align="right">26</td>
<td align="right">11</td>
<td align="right">100</td>
<td align="right">84</td>
</tr>
<tr class="even">
<td align="left">Brooklyn</td>
<td align="right">747</td>
<td align="right">35</td>
<td align="right">8</td>
<td align="right">119</td>
<td align="right">142</td>
</tr>
<tr class="odd">
<td align="left">Manhattan</td>
<td align="right">1002</td>
<td align="right">35</td>
<td align="right">15</td>
<td align="right">195</td>
<td align="right">210</td>
</tr>
</tbody>
</table>
<pre class="r"><code>chisq.test(grade_boro)</code></pre>
<pre><code>## Warning in chisq.test(grade_boro): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  grade_boro
## X-squared = 38.716, df = 16, p-value = 0.001195</code></pre>
<p>Interpretation: The result of chi-square shows that p-value is less
than 0.05, so we reject the null hypothesis at 95% significant level and
conclude that the inspection grades of restaurants are significantly
different by boroughs.</p>
<pre class="r"><code>price_grade = df %&gt;% 
  select(boro, score, grade, rating, review_num, price) %&gt;%
  drop_na(price, grade) %&gt;% 
  group_by(price, grade) %&gt;% 
  summarise(n = n()) %&gt;% 
  pivot_wider(
    names_from = grade,
    values_from = n 
  ) %&gt;% 
  replace(is.na(.), 0) %&gt;% 
  data.matrix() %&gt;%
  subset(select = -c(price))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;price&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre class="r"><code>rownames(price_grade) &lt;- c(&quot;&lt;10$&quot;, &quot;11$-30$&quot;, &quot;31$-60$&quot;, &quot;&gt;60$&quot;)

price_grade %&gt;% 
  knitr::kable(caption = &quot;Results Table&quot;)</code></pre>
<table>
<caption>Results Table</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
<th align="right">N</th>
<th align="right">Z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">&lt;10$</td>
<td align="right">757</td>
<td align="right">46</td>
<td align="right">18</td>
<td align="right">103</td>
<td align="right">161</td>
</tr>
<tr class="even">
<td align="left">11<span class="math inline">\(-30\)</span></td>
<td align="right">1416</td>
<td align="right">48</td>
<td align="right">22</td>
<td align="right">278</td>
<td align="right">267</td>
</tr>
<tr class="odd">
<td align="left">31<span class="math inline">\(-60\)</span></td>
<td align="right">191</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">53</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="left">&gt;60$</td>
<td align="right">43</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">9</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<pre class="r"><code>chisq.test(price_grade)</code></pre>
<pre><code>## Warning in chisq.test(price_grade): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  price_grade
## X-squared = 52.447, df = 12, p-value = 5.166e-07</code></pre>
<p>Interpretation: The result of chi-square shows that p-value is less
than 0.05, so we reject the null hypothesis at 95% significant level and
conclude that the inspection grades of restaurants are significantly
different by price scales of restaurants.</p>
</div>
<div id="proportion-test" class="section level2">
<h2>Proportion Test</h2>
<p>Now, we want to see whether receiving grade A is equally common among
restaurants of all four price scales. To do this, we will conduct a
proportion test.</p>
<pre class="r"><code>total = df %&gt;% 
  group_by(price) %&gt;% 
  summarise(total = n())

n_a = df %&gt;% 
  count(price, grade) %&gt;% 
  filter(grade == &quot;A&quot;)

join = left_join(total, n_a) %&gt;% drop_na()</code></pre>
<pre><code>## Joining, by = &quot;price&quot;</code></pre>
<pre class="r"><code>prop.test(join$n, join$total)</code></pre>
<pre><code>## 
##  4-sample test for equality of proportions without continuity correction
## 
## data:  join$n out of join$total
## X-squared = 7.0161, df = 3, p-value = 0.07139
## alternative hypothesis: two.sided
## sample estimates:
##    prop 1    prop 2    prop 3    prop 4 
## 0.5181383 0.4908146 0.5290859 0.6056338</code></pre>
<pre class="r"><code>#join = join %&gt;% 
 # mutate(prop = n/total) %&gt;% 
 # select(price, prop)</code></pre>
<p>From the test result, we can see that the p-value is greater than
0.05,</p>
</div>
<div id="regression-model" class="section level2">
<h2>Regression model</h2>
<ul>
<li>Response Transformation</li>
</ul>
<pre class="r"><code>df %&gt;% 
  select(boro, cuisine_description, score, grade, rating, review_num, price) %&gt;% 
  ggplot(aes(x = rating))+
  geom_histogram(aes(y = ..density..), bins = 30, color = &quot;black&quot;, fill = &quot;grey&quot;) +
  geom_density()</code></pre>
<p><img src="stat_files/figure-html/unnamed-chunk-7-1.png" width="90%" /></p>
<pre class="r"><code>qqnorm(df$rating)</code></pre>
<p><img src="stat_files/figure-html/unnamed-chunk-7-2.png" width="90%" /></p>
<p>Although the response variable <code>rating</code> is not normally
distributed, linear regression remains a statistically sound technique
since the sample size is large enough (i.e.&gt;3000).</p>
<ul>
<li>Predictor transfomation</li>
</ul>
<pre class="r"><code>top_cuisine = df %&gt;%
  count(cuisine_description) %&gt;% 
  arrange(-n) %&gt;% 
  top_n(4) %&gt;% 
  pull(cuisine_description)</code></pre>
<pre><code>## Selecting by n</code></pre>
<pre class="r"><code>reg_df = df %&gt;% 
  select(boro, cuisine_description, score, grade, rating, review_num, price) %&gt;%
  filter(cuisine_description %in% top_cuisine) %&gt;% 
  filter(grade %in% c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;))
  

dlookr::find_skewness(reg_df)</code></pre>
<pre><code>## [1] 3 5 6</code></pre>
<pre class="r"><code>par(mfrow = c(2, 2))
plot(rating ~ review_num, data = reg_df, col = &quot;dodgerblue&quot;, pch = 20, cex = 1.5)
review = lm(rating ~ review_num, data = reg_df)
abline(review, col = &quot;darkorange&quot;, lwd = 2)
plot(fitted(review), resid(review), col = &quot;dodgerblue&quot;,
     pch = 20, cex = 1.5, xlab = &quot;Fitted&quot;, ylab = &quot;Residuals&quot;)
abline(h = 0, lty = 2, col = &quot;darkorange&quot;, lwd = 2)
title(main = &quot;Before transformation&quot;)

plot(rating ~ log(review_num), data = reg_df, col = &quot;dodgerblue&quot;, pch = 20, cex = 1.5)
review = lm(rating ~ log(review_num), data = reg_df)
abline(review, col = &quot;darkorange&quot;, lwd = 2)
plot(fitted(review), resid(review), col = &quot;dodgerblue&quot;,
     pch = 20, cex = 1.5, xlab = &quot;Fitted&quot;, ylab = &quot;Residuals&quot;)
abline(h = 0, lty = 2, col = &quot;darkorange&quot;, lwd = 2)
title(main = &quot;After transformation&quot;)</code></pre>
<p><img src="stat_files/figure-html/unnamed-chunk-8-1.png" width="90%" /></p>
<pre class="r"><code>plot(rating ~ score, data = reg_df, col = &quot;dodgerblue&quot;, pch = 20, cex = 1.5)
rating_score = lm(rating ~ score, data = reg_df)
abline(rating_score, col = &quot;darkorange&quot;, lwd = 2)
plot(fitted(rating_score), resid(rating_score), col = &quot;dodgerblue&quot;,
     pch = 20, cex = 1.5, xlab = &quot;Fitted&quot;, ylab = &quot;Residuals&quot;)
abline(h = 0, lty = 2, col = &quot;darkorange&quot;, lwd = 2)</code></pre>
<p><img src="stat_files/figure-html/unnamed-chunk-8-2.png" width="90%" /></p>
<p>Log transform review numbers:</p>
<pre class="r"><code>reg_df = reg_df %&gt;% 
  select(rating, everything()) %&gt;% 
  mutate(review_num = log(review_num))</code></pre>
<p>Rating has some association with cuisine type, inspection grade and
price scale.</p>
<pre class="r"><code>reg_df %&gt;% 
  ggplot(aes(y = rating, color = cuisine_description))+
  geom_boxplot()</code></pre>
<p><img src="stat_files/figure-html/unnamed-chunk-10-1.png" width="90%" /></p>
<pre class="r"><code>reg_df %&gt;%
  ggplot(aes(y = rating, color = grade))+
  geom_boxplot()</code></pre>
<p><img src="stat_files/figure-html/unnamed-chunk-10-2.png" width="90%" /></p>
<pre class="r"><code>reg_df %&gt;%
  drop_na(price) %&gt;% 
  ggplot(aes(y = rating, color = price))+
  geom_boxplot()</code></pre>
<p><img src="stat_files/figure-html/unnamed-chunk-10-3.png" width="90%" /></p>
<pre class="r"><code>reg_df %&gt;%
  mutate(boro = fct_reorder(boro, rating)) %&gt;% 
  ggplot(aes(y = rating, color = boro))+
  geom_boxplot()</code></pre>
<p><img src="stat_files/figure-html/unnamed-chunk-10-4.png" width="90%" /></p>
<p>There is interaction between score and cuisine type:</p>
<pre class="r"><code>reg_df %&gt;% 
  ggplot(aes(x = score, y = rating, color = cuisine_description))+
  geom_point()+
  geom_smooth(method=&quot;lm&quot;, se=F, aes(group = cuisine_description, color = cuisine_description))</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="stat_files/figure-html/unnamed-chunk-11-1.png" width="90%" /></p>
<p>Score has little influence on rating, borough is not a
confounder.</p>
<pre class="r"><code>reg_df %&gt;% 
  ggplot(aes(x = score, y = rating, color = boro))+
  geom_point()+
  geom_smooth(method=&quot;lm&quot;, se=F, aes(group = boro, color = boro))</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="stat_files/figure-html/unnamed-chunk-12-1.png" width="90%" /></p>
<pre class="r"><code>model = lm(rating ~ cuisine_description*score+boro+review_num+price, data = reg_df)
summary(model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = rating ~ cuisine_description * score + boro + review_num + 
##     price, data = reg_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.95854 -0.35730  0.07522  0.45832  1.53066 
## 
## Coefficients:
##                                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                          3.619349   0.125224  28.903  &lt; 2e-16 ***
## cuisine_descriptionChinese          -0.338116   0.107048  -3.159  0.00163 ** 
## cuisine_descriptionCoffee/Tea        0.349770   0.105737   3.308  0.00097 ***
## cuisine_descriptionPizza            -0.130140   0.121709  -1.069  0.28518    
## score                               -0.012431   0.005317  -2.338  0.01958 *  
## boroStaten Island                    0.128106   0.131025   0.978  0.32843    
## boroQueens                           0.178944   0.103113   1.735  0.08295 .  
## boroBrooklyn                         0.297255   0.099475   2.988  0.00287 ** 
## boroManhattan                        0.217468   0.100970   2.154  0.03147 *  
## review_num                          -0.006815   0.013125  -0.519  0.60369    
## price2                               0.078986   0.044687   1.768  0.07742 .  
## price3                               0.183873   0.090489   2.032  0.04240 *  
## price4                               0.163006   0.175042   0.931  0.35193    
## cuisine_descriptionChinese:score     0.011285   0.008506   1.327  0.18487    
## cuisine_descriptionCoffee/Tea:score -0.002098   0.009537  -0.220  0.82590    
## cuisine_descriptionPizza:score       0.013779   0.009404   1.465  0.14312    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6531 on 1094 degrees of freedom
##   (49 observations deleted due to missingness)
## Multiple R-squared:  0.1018, Adjusted R-squared:  0.08949 
## F-statistic: 8.267 on 15 and 1094 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>10-fold cross validation:</p>
<pre class="r"><code>library(caret)</code></pre>
<pre><code>## Warning: package &#39;caret&#39; was built under R version 4.2.2</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## 
## Attaching package: &#39;caret&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     lift</code></pre>
<pre class="r"><code>set.seed(1)
train = trainControl(method = &quot;cv&quot;, number = 10)
model = train(rating ~ cuisine_description*score+boro+review_num+price, 
              data = reg_df,
              trControl = train,
              method = &#39;lm&#39;,
              na.action = na.pass)
model$finalModel</code></pre>
<pre><code>## 
## Call:
## lm(formula = .outcome ~ ., data = dat)
## 
## Coefficients:
##                           (Intercept)             cuisine_descriptionChinese  
##                              3.619349                              -0.338116  
##       `cuisine_descriptionCoffee/Tea`               cuisine_descriptionPizza  
##                              0.349770                              -0.130140  
##                                 score                    `boroStaten Island`  
##                             -0.012431                               0.128106  
##                            boroQueens                           boroBrooklyn  
##                              0.178944                               0.297255  
##                         boroManhattan                             review_num  
##                              0.217468                              -0.006815  
##                                price2                                 price3  
##                              0.078986                               0.183873  
##                                price4     `cuisine_descriptionChinese:score`  
##                              0.163006                               0.011285  
## `cuisine_descriptionCoffee/Tea:score`       `cuisine_descriptionPizza:score`  
##                             -0.002098                               0.013779</code></pre>
<pre class="r"><code>print(model)</code></pre>
<pre><code>## Linear Regression 
## 
## 1159 samples
##    5 predictor
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold) 
## Summary of sample sizes: 1044, 1043, 1042, 1042, 1044, 1044, ... 
## Resampling results:
## 
##   RMSE       Rsquared    MAE      
##   0.6552474  0.08644057  0.5098479
## 
## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE</code></pre>
<p>Elastic Net</p>
<pre class="r"><code>library(glmnet)</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<pre><code>## Loaded glmnet 4.1-4</code></pre>
<pre class="r"><code>library(caret)
set.seed(2)
cv_10 = trainControl(method = &quot;cv&quot;, number = 10)
x = model.matrix(~ ., dplyr::select(reg_df, -rating))[,-1]
y = reg_df$rating
elnet_int = train(
  rating ~ . ^ 2, data = reg_df %&gt;% drop_na(),
  method = &quot;glmnet&quot;,
  trControl = cv_10,
  tuneLength = 10
)

get_best_result = function(caret_fit) {
  best = which(rownames(caret_fit$results) == rownames(caret_fit$bestTune))
  best_result = caret_fit$results[best, ]
  rownames(best_result) = NULL
  best_result
}

get_best_result(elnet_int)</code></pre>
<pre><code>##   alpha     lambda      RMSE  Rsquared       MAE     RMSESD RsquaredSD
## 1   0.5 0.01133025 0.6513376 0.1044305 0.5053224 0.03475528  0.0544117
##        MAESD
## 1 0.02856097</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
