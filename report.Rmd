---
title: "Project report"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
    theme: flatly
---

## Motivation
One metric consistently missing in restaurant recommendation apps is the consideration for sanitary conditions. Combining the Inspection dataset and ratings information from the most popular rating website Yelp, we provide recommendations for restaurants in NYC based on oneâ€™s choice of price range, sanitary grading, location, and cuisine type.

## Initial Questions

## Related Work

## Data Collection and Cleaning

We used two data sets to complete our analysis. 

### a. [DOHMH NYC Restaurant Inspection Data](https://data.cityofnewyork.us/Health/DOHMH-New-York-City-Restaurant-Inspection-Results/43nn-pn8j)

This dataset provided by Department of Health and Mental Hygiene (DOHMH) contains detailed information on restaurant inspection results. We downloaded and imported the version updated on Nov. 17th. Since this file is too large to be uoloaded on Github, we used Github Large File System to store it and its cleaning results. 

In the process of data cleaning, we formatted variables, identified illegal values and dropped NAs. The distinct restaurants are filtered to be our targets. 

After cleaning, we are mainly focus on variables shown below:

  - `score`: Total score for a particular inspection.
  
  - `grade`: Grade associated with the inspection. 
  
  - `violation_description`: Violation description type associated with the  inspection. 
  
  - `critical_flag`: Indicator of critical violation. 
  
Some examples of the variables include: inspection score and corresponding letter grade, violation description, date, types of cuisine, and the borough in which the restaurant is located in, etc.

### b. [Yelp Data](https://www.yelp.com/search?find_desc=Restaurants&find_loc=New+York%2C+NY)

After identifying the first 8000 distinct restaurant with latest inspection records, we extracted their name and location information to generate Yelp  searching URLs, and used the corresponding CSS tags to pull real-time information, including the restaurant name, review scores, price, number of reviews, and location for each restaurant. 


## Exploratory analysis
For our exploratory analyses, we aim to observe patterns related to inspection information and cuisine types across different boroughs and price levels. Meanwhile, the latent associations between sanitary grading, inspection-related variables, review numbers, and rating are our particular interests. The exploratory analyses consist of two main parts: visualization and mapping of cuisine types and ratings in different boroughs and at price levels, visualization and mapping of critical inspection information.

### Visulization of cuisine types and ratings in NYC
Based on our data frame, we get the top 10 popular cuisine types in NYC and in different boroughs across NYC. `American`, `Chinese` are always among people's favorites, while citizens in different boroughs shows their different preferences. Then, we visualized the pattern of the top 10 frequent cuisine at different price, which can be useful when considering the preferences at different levels of consumption. After that, restaurants at different price levels by borough are inspected. 
We then discover the association between review number and review scores. Living in a era full of bots and artificial intelligence, it's interesting to have some inspection on them. Meanwhile, the review scores by price levels are visualized. At last, we mapped the geolocation of restaurants by price and cuisine types. 

### violation 
After grouping the data by the types of violation, we identified the 10 most frequent violations to gain an understanding of the general problems faced by the restaurants. More specifically, we look at the proportions of violations made by each restaurant and calculated the proportion that was categorized as "critical". We found that more than 50 percent of the violations are not critical. In addition, the ratio of critical to non-critical violations is approximately the same across different boroughs of NYC.

In terms of the performance during inspection, the majority of the restaurants in NYC received an "A" as the inspection grade, either during the initial inspection or re-inspection. Among all boroughs in NYC, Bronx was the one with the largest proportion of restaurants receiving a grade "C" while no documented restaurant in Staten Island received a "C".

## Statistical Analysis

## Shiny app

We developed and deployed an Shiny App for users to get appropriate and interactive recommendations based on their personalized input. 
Users can receive key information of each restaurant from the table and see the locations of on the map. 
The table can be sorted by each variables based on users' preference. 
By clicking a specific entry of the table, the latest inspection records of the corresponding restaurant will be shown in the lower right.

![](./pic/Shiny_Screen_Shot.png)