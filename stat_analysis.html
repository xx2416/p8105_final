<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Statistical Analysis</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Exploratory Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="eda.html">Yelp Review Data</a>
    </li>
    <li>
      <a href="map.html">NYC Inspection Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Statistical Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="stat_analysis.html">Data exploration</a>
    </li>
    <li>
      <a href="stat.html">Model Selection</a>
    </li>
  </ul>
</li>
<li>
  <a href="report.html">Project Report</a>
</li>
<li>
  <a href="https://sweetsugar.shinyapps.io/recommender">Shiny app</a>
</li>
<li>
  <a href="mailto:&lt;js6177@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/xx2416/p8105_final">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistical Analysis</h1>

</div>


<div id="dataset-overview" class="section level2">
<h2>Dataset Overview</h2>
<div id="data-wrangling" class="section level3">
<h3>Data Wrangling</h3>
<p>In this first step, we wrangle the data such that it is suitable for
statistical analysis and provide an overview for the dataset of use. In
particular, we create a new numeric variable, percent_critical, that
accounts for the percentage of critical flags a given restaurant
receives out of all violations. Moreover, we factorize categorical
variables price, borough, and grade; before finally making distinct each
restaurant such that each represent a unique row.</p>
<pre class="r"><code>library(readr)
# dt = read_csv(&quot;data/inspection_sub_all_date.csv&quot;)
df = read_csv(&quot;data/inspection_sub_latest_date.csv&quot;) %&gt;%
  mutate(price = fct_recode(price, &quot;1&quot; = &quot;$&quot;, &quot;2&quot; = &quot;$$&quot;, &quot;3&quot; = &quot;$$$&quot;, &quot;4&quot; = &quot;$$$$&quot;),
         boro = fct_reorder(boro, rating),
         grade = fct_relevel(grade, &quot;A&quot;)) %&gt;%
  group_by(camis) %&gt;%
  mutate(percent_critical = sum(critical_flag == &quot;Critical&quot;)/n())

# Make distinction such that each restaurant is its unique row.
df &lt;- df %&gt;% 
  distinct(camis, .keep_all = TRUE) %&gt;%
  ungroup() %&gt;% # select desired variables
  select(dba, boro, grade, zipcode, cuisine_description, inspection_type, rating, review_num, price, percent_critical, score)

# Display data
head(df)</code></pre>
<pre><code>## # A tibble: 6 × 11
##   dba     boro  grade zipcode cuisi…¹ inspe…² rating revie…³ price perce…⁴ score
##   &lt;chr&gt;   &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 WILKEN… Broo… A       11234 Sandwi… Cycle …    3.2      57 2       0         2
## 2 P &amp; S … Manh… A       10025 Americ… Cycle …    4       605 2       0.333    12
## 3 CARVEL  Stat… A       10305 Frozen… Cycle …    2.5      25 2       0.5       7
## 4 KOSHER… Broo… A       11230 Jewish… Cycle …    4.1      68 1       0.333    13
## 5 OLD TO… Manh… A       10003 Americ… Cycle …    3.6     410 2       0.333    13
## 6 7B BAR  Manh… A       10009 Americ… Cycle …    3.4     211 1       0.667    10
## # … with abbreviated variable names ¹​cuisine_description, ²​inspection_type,
## #   ³​review_num, ⁴​percent_critical</code></pre>
</div>
<div id="summary-of-wrangled-data" class="section level3">
<h3>Summary of Wrangled Data</h3>
<p>Now, a brief summary of our dataset to use.</p>
<pre class="r"><code>df %&gt;% 
  ungroup() %&gt;%
  select(boro, grade, price) %&gt;% 
  mutate(boro = fct_infreq(boro)) %&gt;% 
  tbl_summary(
    by = boro,
    missing_text = &quot;(Missing)&quot;, 
    statistic = list(
      all_categorical() ~ &quot;{n} ({p}%)&quot;
      )) %&gt;% 
  bold_labels() %&gt;%   
  italicize_levels() </code></pre>
<div id="gzwizmqkcd" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#gzwizmqkcd .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gzwizmqkcd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gzwizmqkcd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gzwizmqkcd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gzwizmqkcd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gzwizmqkcd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gzwizmqkcd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gzwizmqkcd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gzwizmqkcd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gzwizmqkcd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gzwizmqkcd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gzwizmqkcd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#gzwizmqkcd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gzwizmqkcd .gt_from_md > :first-child {
  margin-top: 0;
}

#gzwizmqkcd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gzwizmqkcd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gzwizmqkcd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gzwizmqkcd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gzwizmqkcd .gt_row_group_first td {
  border-top-width: 2px;
}

#gzwizmqkcd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gzwizmqkcd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gzwizmqkcd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gzwizmqkcd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gzwizmqkcd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gzwizmqkcd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gzwizmqkcd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gzwizmqkcd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gzwizmqkcd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gzwizmqkcd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gzwizmqkcd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gzwizmqkcd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gzwizmqkcd .gt_left {
  text-align: left;
}

#gzwizmqkcd .gt_center {
  text-align: center;
}

#gzwizmqkcd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gzwizmqkcd .gt_font_normal {
  font-weight: normal;
}

#gzwizmqkcd .gt_font_bold {
  font-weight: bold;
}

#gzwizmqkcd .gt_font_italic {
  font-style: italic;
}

#gzwizmqkcd .gt_super {
  font-size: 65%;
}

#gzwizmqkcd .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#gzwizmqkcd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gzwizmqkcd .gt_indent_1 {
  text-indent: 5px;
}

#gzwizmqkcd .gt_indent_2 {
  text-indent: 10px;
}

#gzwizmqkcd .gt_indent_3 {
  text-indent: 15px;
}

#gzwizmqkcd .gt_indent_4 {
  text-indent: 20px;
}

#gzwizmqkcd .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>Manhattan</strong>, N = 2,422<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>Brooklyn</strong>, N = 1,671<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>Queens</strong>, N = 1,302<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>Bronx</strong>, N = 424<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>Staten Island</strong>, N = 234<sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left" style="font-weight: bold;">grade</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    A</td>
<td class="gt_row gt_center">1,280 (71%)</td>
<td class="gt_row gt_center">913 (74%)</td>
<td class="gt_row gt_center">666 (74%)</td>
<td class="gt_row gt_center">194 (71%)</td>
<td class="gt_row gt_center">148 (77%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    B</td>
<td class="gt_row gt_center">41 (2.3%)</td>
<td class="gt_row gt_center">39 (3.1%)</td>
<td class="gt_row gt_center">29 (3.2%)</td>
<td class="gt_row gt_center">6 (2.2%)</td>
<td class="gt_row gt_center">4 (2.1%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    C</td>
<td class="gt_row gt_center">16 (0.9%)</td>
<td class="gt_row gt_center">8 (0.6%)</td>
<td class="gt_row gt_center">12 (1.3%)</td>
<td class="gt_row gt_center">8 (2.9%)</td>
<td class="gt_row gt_center">0 (0%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    N</td>
<td class="gt_row gt_center">225 (13%)</td>
<td class="gt_row gt_center">126 (10%)</td>
<td class="gt_row gt_center">109 (12%)</td>
<td class="gt_row gt_center">37 (14%)</td>
<td class="gt_row gt_center">27 (14%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    Z</td>
<td class="gt_row gt_center">233 (13%)</td>
<td class="gt_row gt_center">156 (13%)</td>
<td class="gt_row gt_center">90 (9.9%)</td>
<td class="gt_row gt_center">27 (9.9%)</td>
<td class="gt_row gt_center">12 (6.3%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    (Missing)</td>
<td class="gt_row gt_center">627</td>
<td class="gt_row gt_center">429</td>
<td class="gt_row gt_center">396</td>
<td class="gt_row gt_center">152</td>
<td class="gt_row gt_center">43</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">price</td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td>
<td class="gt_row gt_center"></td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    1</td>
<td class="gt_row gt_center">653 (28%)</td>
<td class="gt_row gt_center">668 (41%)</td>
<td class="gt_row gt_center">542 (44%)</td>
<td class="gt_row gt_center">209 (53%)</td>
<td class="gt_row gt_center">92 (41%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    2</td>
<td class="gt_row gt_center">1,420 (60%)</td>
<td class="gt_row gt_center">856 (53%)</td>
<td class="gt_row gt_center">655 (53%)</td>
<td class="gt_row gt_center">171 (44%)</td>
<td class="gt_row gt_center">123 (55%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    3</td>
<td class="gt_row gt_center">240 (10%)</td>
<td class="gt_row gt_center">76 (4.7%)</td>
<td class="gt_row gt_center">34 (2.7%)</td>
<td class="gt_row gt_center">9 (2.3%)</td>
<td class="gt_row gt_center">8 (3.6%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    4</td>
<td class="gt_row gt_center">49 (2.1%)</td>
<td class="gt_row gt_center">10 (0.6%)</td>
<td class="gt_row gt_center">9 (0.7%)</td>
<td class="gt_row gt_center">2 (0.5%)</td>
<td class="gt_row gt_center">2 (0.9%)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    (Missing)</td>
<td class="gt_row gt_center">60</td>
<td class="gt_row gt_center">61</td>
<td class="gt_row gt_center">62</td>
<td class="gt_row gt_center">33</td>
<td class="gt_row gt_center">9</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="6"><sup class="gt_footnote_marks">1</sup> n (%)</td>
    </tr>
  </tfoot>
</table>
</div>
<pre class="r"><code>df %&gt;% 
  ungroup() %&gt;%
  select(score,rating, review_num) %&gt;% 
  tbl_summary(
    missing_text = &quot;(Missing)&quot;, 
    statistic = list(
      all_continuous() ~ &quot;{mean} ({sd})&quot;
      )) %&gt;% 
  bold_labels() %&gt;%   
  italicize_levels() </code></pre>
<div id="roqbyglpkn" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#roqbyglpkn .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#roqbyglpkn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#roqbyglpkn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#roqbyglpkn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#roqbyglpkn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#roqbyglpkn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#roqbyglpkn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#roqbyglpkn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#roqbyglpkn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#roqbyglpkn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#roqbyglpkn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#roqbyglpkn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#roqbyglpkn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#roqbyglpkn .gt_from_md > :first-child {
  margin-top: 0;
}

#roqbyglpkn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#roqbyglpkn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#roqbyglpkn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#roqbyglpkn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#roqbyglpkn .gt_row_group_first td {
  border-top-width: 2px;
}

#roqbyglpkn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#roqbyglpkn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#roqbyglpkn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#roqbyglpkn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#roqbyglpkn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#roqbyglpkn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#roqbyglpkn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#roqbyglpkn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#roqbyglpkn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#roqbyglpkn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#roqbyglpkn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#roqbyglpkn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#roqbyglpkn .gt_left {
  text-align: left;
}

#roqbyglpkn .gt_center {
  text-align: center;
}

#roqbyglpkn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#roqbyglpkn .gt_font_normal {
  font-weight: normal;
}

#roqbyglpkn .gt_font_bold {
  font-weight: bold;
}

#roqbyglpkn .gt_font_italic {
  font-style: italic;
}

#roqbyglpkn .gt_super {
  font-size: 65%;
}

#roqbyglpkn .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#roqbyglpkn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#roqbyglpkn .gt_indent_1 {
  text-indent: 5px;
}

#roqbyglpkn .gt_indent_2 {
  text-indent: 10px;
}

#roqbyglpkn .gt_indent_3 {
  text-indent: 15px;
}

#roqbyglpkn .gt_indent_4 {
  text-indent: 20px;
}

#roqbyglpkn .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>N = 6,053</strong><sup class="gt_footnote_marks">1</sup></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left" style="font-weight: bold;">score</td>
<td class="gt_row gt_center">17 (13)</td></tr>
    <tr><td class="gt_row gt_left" style="font-style: italic;">    (Missing)</td>
<td class="gt_row gt_center">130</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">rating</td>
<td class="gt_row gt_center">3.62 (0.79)</td></tr>
    <tr><td class="gt_row gt_left" style="font-weight: bold;">review_num</td>
<td class="gt_row gt_center">209 (459)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="2"><sup class="gt_footnote_marks">1</sup> Mean (SD)</td>
    </tr>
  </tfoot>
</table>
</div>
<p>From these results, we observe that:</p>
<ul>
<li><p>Manhattan has the most restaurants (40% of all restaurants in the
city), followed by Brooklyn (28%), Queens (22%), Bronx (6.6%), and
Staten Island (3.4%).</p></li>
<li><p>The “score” variable has 100 missing values with mean 18 and
standard deviation 14.</p></li>
<li><p>The “grade” variable has 1,399 missing values with most of the
restaurants receiving As (70% of all restaurants).</p></li>
<li><p>Each restaurant has average rating 3.78 with standard deviation
0.68.</p></li>
<li><p>Each restaurant has on average 232 reviews with standard
deviation 485.</p></li>
<li><p>The most common price range for restaurants is between $11-$30
(60%), followed by under $10 (31%).</p></li>
</ul>
</div>
</div>
<div id="chi-square-test" class="section level2">
<h2>Chi-square Test</h2>
<p>Now, we conduct chi-square tests to get a sense of whether boro and
price range has an effect on the inspection grade that a given
restaurant receives. Since the inspection grades reflect the extent of
health hazards one might take risk of in dining at that particular
restaurant and has been required by the City since 2010 for restaurants
to post letter grades that correspond to scores received from sanitary
inspections, this investigation might shed light on the whether dining
at a particular borough or price range increases one’s danger of food
poisoning or other food-borne diseases.</p>
<div id="inspection-grades-and-boroughs" class="section level3">
<h3>Inspection Grades and Boroughs</h3>
<p>We try to determine whether there is a relationship between boroughs
and restaurants’ inspection grades. Our hypothesis is that there is no
difference in the number of restaurants across the five grades across
the five boroughs in NYC. We will perform the chi-square test to verify
our assumption.</p>
<p><span class="math inline">\(H0\)</span>: the expected number of
restaurants in each grades are the same across all boroughs.</p>
<p><span class="math inline">\(H1\)</span>: the expected number of
restaurants in each grades are not same across all boroughs.</p>
<pre class="r"><code>grade_boro = 
  df %&gt;% 
  ungroup() %&gt;%
  filter(grade %in% c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;)) %&gt;% 
  count(boro, grade) %&gt;% 
  pivot_wider(
    names_from = &quot;grade&quot;,
    values_from = &quot;n&quot;) %&gt;%
  replace(is.na(.), 0) 

# Display results table.
grade_boro %&gt;% 
  knitr::kable(caption = &quot;Results Table&quot;,
               col.names = c(&quot;Borough&quot;, &quot;A&quot;, &quot;B&quot;, &quot;C&quot;))</code></pre>
<table>
<caption>Results Table</caption>
<thead>
<tr class="header">
<th align="left">Borough</th>
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bronx</td>
<td align="right">194</td>
<td align="right">6</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">Staten Island</td>
<td align="right">148</td>
<td align="right">4</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Queens</td>
<td align="right">666</td>
<td align="right">29</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">Brooklyn</td>
<td align="right">913</td>
<td align="right">39</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">Manhattan</td>
<td align="right">1280</td>
<td align="right">41</td>
<td align="right">16</td>
</tr>
</tbody>
</table>
<pre class="r"><code>grade_boro = grade_boro %&gt;%  
  data.matrix() %&gt;%
  subset(select = -c(boro))

# Perform chi-square test
chisq.test(grade_boro)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  grade_boro
## X-squared = 17.93, df = 8, p-value = 0.02176</code></pre>
<p>Interpretation: Since p-value is less than 0.05, we reject the null
hypothesis at 95% significant level and conclude that the inspection
grades of restaurants are significantly different by boroughs. In other
words, dining at different boroughs in NYC carries different risk of
food-related health hazards.</p>
</div>
<div id="price-and-inspection-grade" class="section level3">
<h3>Price and Inspection Grade</h3>
<p>Now, the reason that many might choose a restaurant of higher price
range out of safety concerns. In this part we investigate if such is
true with restaurants in NYC: does price range of a restaurant has an
effect on its safety levels?</p>
<p><span class="math inline">\(H0\)</span>: There is no difference in
the inspection grade received among the four different groups of price
range.</p>
<p><span class="math inline">\(H1\)</span>: There is a difference in the
inspection grade received among the four different groups of price
range.</p>
<pre class="r"><code>price_grade = df %&gt;% 
  select(boro, score, grade, rating, review_num, price) %&gt;%
  drop_na(price, grade) %&gt;% 
  filter(grade %in% c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;)) %&gt;% 
  group_by(price, grade) %&gt;% 
  summarise(n = n()) %&gt;% 
  pivot_wider(
    names_from = grade,
    values_from = n 
  ) %&gt;% 
  replace(is.na(.), 0) %&gt;% 
  mutate(price = fct_recode(price, &quot;&lt;10&quot;=&quot;1&quot;, &quot;11-30&quot;=&quot;2&quot;, &quot;31-60&quot;=&quot;3&quot;, &quot;&gt;60&quot;=&quot;4&quot;))

price_grade %&gt;% 
  knitr::kable(caption = &quot;Results Table&quot;,
               col.names = c(&quot;Price($)&quot;, &quot;A&quot;, &quot;B&quot;, &quot;C&quot;))</code></pre>
<table>
<caption>Results Table</caption>
<thead>
<tr class="header">
<th align="left">Price($)</th>
<th align="right">A</th>
<th align="right">B</th>
<th align="right">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">&lt;10</td>
<td align="right">1228</td>
<td align="right">54</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="left">11-30</td>
<td align="right">1623</td>
<td align="right">57</td>
<td align="right">23</td>
</tr>
<tr class="odd">
<td align="left">31-60</td>
<td align="right">194</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">&gt;60</td>
<td align="right">44</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code>price_grade = price_grade %&gt;% 
  data.matrix() %&gt;%
  subset(select = -c(price))

# Perform chi-square test
chisq.test(price_grade)</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  price_grade
## X-squared = 7.5714, df = 6, p-value = 0.2712</code></pre>
<p>Interpretation: The result of chi-square shows that p-value is more
than 0.05, so we fail to reject the null hypothesis at 95% significant
level and conclude that we don’t have sufficient evidence to claim that
the inspection grades of restaurants differ by price scales of
restaurants. In other words, the results from this analysis tells us
that the urban myth that dining in more expensive restaurant avoids
health hazards is unfounded.</p>
</div>
</div>
<div id="proportion-test" class="section level2">
<h2>Proportion Test</h2>
<div id="price-and-receiving-a" class="section level3">
<h3>Price and Receiving “A”</h3>
<p>Now, we want to see whether receiving grade A is equally common among
restaurants of all four price scales. To do this, we will conduct a
proportion test.</p>
<p><span class="math inline">\(H0\)</span>: Receiving A is equally
common among restaurants fo all four price scales.</p>
<p><span class="math inline">\(H1\)</span>: Receiving A is not equally
common among restaurants for all four price scales.</p>
<pre class="r"><code>total = df %&gt;% 
  group_by(price) %&gt;% 
  summarise(total = n()) %&gt;%
  drop_na()

n_a = df %&gt;% 
  ungroup() %&gt;%
  count(price, grade) %&gt;% 
  filter(grade == &quot;A&quot;)

join = left_join(total, n_a)
prop.test(join$n, join$total)</code></pre>
<pre><code>## 
##  4-sample test for equality of proportions without continuity correction
## 
## data:  join$n out of join$total
## X-squared = 23.36, df = 3, p-value = 3.397e-05
## alternative hypothesis: two.sided
## sample estimates:
##    prop 1    prop 2    prop 3    prop 4 
## 0.5674677 0.5032558 0.5286104 0.6111111</code></pre>
<pre class="r"><code>#join = join %&gt;% 
 # mutate(prop = n/total) %&gt;% 
 # select(price, prop)</code></pre>
<p>Interpretation: since p-value &lt;&lt; 0.05, at confidence level of
95%, we reject the null hypothesis and conclude that the proportion of
restaurants receiving “A” is different among four datasets. Therefore,
although the results from chi-square test tells us that dining at a
particular price does not affect the overall health hazard that one
faces, nonetheless the price range does seem to have an effect on
whether the restaurant one dines at received an “A” as inspection
grade.</p>
</div>
<div id="proportion-of-as-received-for-each-cuisine"
class="section level3">
<h3>Proportion of “A”s received for Each Cuisine</h3>
<p>Since we have received a statistically significant result for price
range against receiving an “A” grade, what about the proportion of
restaurants receiving “A” for each cuisine type? To answer this
question, we group data by cuisine type and perform proportion test on
the percentage of A received. In particular, to reduce data variability,
swe concern only the cuisine types in which there are at least 10
restaurants in our dataset.</p>
<pre class="r"><code># create dataset grouped by cuisine_type
cuisine_df &lt;- df %&gt;% 
  ungroup() %&gt;%
  group_by(cuisine_description) %&gt;%
  summarise(total_evals = n(),
            a_evals = sum(grade == &quot;A&quot;, na.rm = TRUE)) %&gt;%
  filter(total_evals &gt;= 10)

test_full = cuisine_df %&gt;%
  mutate(prop_test = map2(a_evals, total_evals, ~prop.test(.x, .y) %&gt;%
           broom::tidy())) %&gt;%
  unnest() %&gt;% # pull estimated proportion and confidence intervals
  select(cuisine_description, estimate, lower_CI = conf.low, upper_CI = conf.high)

# Display result
test_full %&gt;%
  mutate(cuisine_type = fct_reorder(cuisine_description, estimate)) %&gt;%
  ggplot(aes(x = cuisine_type, y = estimate, ymin = lower_CI, ymax = upper_CI, col = estimate)) + 
  geom_point() + 
  geom_errorbar() +
  coord_flip() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="stat_analysis_files/figure-html/unnamed-chunk-6-1.png" width="90%" /></p>
<p>As we can observe, soups/salads/sandwich restauants are most likely
to receive As, followed by donuts, salads, and vegan.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
